# Malware EXE Download Step-by-Step Guide

## Initial PCAP Load and Inspection  
Loaded the PCAP file into Wireshark to begin analysis.  
Observed traffic within the LAN and external HTTP communications.  

---

## Step 1: Identify Windows Client IP and MAC Address  
**Wireshark filter:**  
ip.src == 192.168.2.147

Verified source MAC address from Ethernet II header:  
`ASRockIncorp_a6:d1:29 (bc:5f:f4:a6:d1:29)`  

![01-windows-client-ip-mac.png](screenshots/01-windows-client-ip-mac.png)
---

## Step 2: Determine Hostname via NetBIOS and DNS Queries  
**Wireshark filter:**  
ip.addr == 192.168.2.147 && (nbns || dns)

Found hostname:  
`LYAKH-WIN7-PC`  

![02-windows-client-hostname.png](screenshots/02-windows-client-hostname.png)

---

## Step 3: Extract Windows User Account from Kerberos Traffic  
**Wireshark filter:**  
ip.src == 192.168.2.147 && kerberos

Located Kerberos `cname-string` field revealing user account:  
`jermija.lyakh`  

![03-kerberos-user-account.png](screenshots/03-kerberos-user-account.png)

---

## Step 4: Identify Malicious Executable Download via HTTP  
**Wireshark filter:**  
http.request.uri contains ".exe"

Found HTTP GET request for executable:  
`GET /hojuks/vez.exe HTTP/1.1`  
Destination IP: `198.54.126.123`  

![04-http-get-exe-request.png](screenshots/04-http-get-exe-request.png)

---

## Step 5: Note Timestamp of Executable Request  
Inspect frame details for request timestamp (UTC):  
`2018-11-13 02:02:13.680850`  

![05-http-get-exe-timestamp.png](screenshots/05-http-get-exe-timestamp.png)

---

## Step 6: Verify HTTP Response and Content Length  
**Wireshark filter:**  
ip.addr == 198.54.126.123 && http

Found HTTP 200 OK response with `Content-Length: 699392` bytes  

![06-http-response-content-length.png](screenshots/06-http-response-content-length.png)

---

## Step 7: Extract and Verify Malicious Executable File  
Exported the executable file from the HTTP response using Wireshark’s **File → Export Objects → HTTP** feature.  

![07-export-exe-file1.png](screenshots/07-export-exe-file1.png)  
![07-export-exe-file2.png](screenshots/07-export-exe-file2.png)

Calculated SHA256 hash using PowerShell command:  
```powershell
Get-FileHash "path\to\vez.exe" -Algorithm SHA256

Resulting hash:
43092b2993c9d9cfab01aa340bc378cad547ae0938c6803cb580271139798765

!(08-sha256-hash-calculation.png)

Verified hash with VirusTotal confirming Trojan malware.

![09-virustotal-report.png](screenshots/09-virustotal-report.png)

